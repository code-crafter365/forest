@article{MAHMOUDI2025105853,
title = {Addressing class imbalance in micro-CT image segmentation: A modified U-Net model with pixel-level class weighting},
journal = {Computers & Geosciences},
volume = {196},
pages = {105853},
year = {2025},
issn = {0098-3004},
doi = {https://doi.org/10.1016/j.cageo.2025.105853},
url = {https://www.sciencedirect.com/science/article/pii/S0098300425000032},
author = {Shahin Mahmoudi and Omid Asghari and Jeff Boisvert},
keywords = {Digital rock physics, Image analysis, Micro X-ray computed tomography, Segmentation, Modified U-Net, Pixel-level class weighting},
abstract = {Micro X-ray Computed Tomography (micro-CT) segmentation is a cornerstone in Digital Rock Physics (DRP), enabling detailed analysis of pore structures and mineral distributions. However, class imbalance remains a critical challenge, often resulting in biased segmentation outcomes. To address this, a methodology combining a modified U-Net architecture with a Pixel-Level Class Weighting (PCW) strategy is introduced. Unlike traditional class-level weighting, PCW assigns weights at the pixel level, offering finer control over segmentation by prioritizing minority classes and challenging pixels. This approach leverages modern deep learning frameworks, where input, label, and weight maps are jointly fed into the network, facilitating dynamic adjustments to emphasize task-specific regions. The modified U-Net incorporates dynamic dropout layers, L2 regularization, and optimized convolutional filters, enhancing computational efficiency and generalization. A dataset of only 40 micro-CT slices from two unique Bentheimer sandstone core samples is used for training and validation. When testing blindly on a third unique core sample, the modified U-Net with PCW increased the F1 score from 0.88 to 0.95. The model maintains the F1 score of majority classes 'pore' and 'quartz', while increasing the F1 score of minority classes 'clay' and 'feldspar' by 31% and 4.2%, respectively. Accurate segmentation of micro-CT images directly impacts downstream computational modeling in petroleum fields, improving permeability and porosity predictions essential for reservoir characterization and fluid flow simulations. The proposed framework represents an efficient, robust solution for imbalanced segmentation tasks, with potential applications in geosciences, such as mineral prospectivity mapping and geochemical anomaly detection.}
}