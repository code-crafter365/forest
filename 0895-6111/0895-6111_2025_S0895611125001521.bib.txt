@article{KHAWALED2025102643,
title = {A self-attention model for robust rigid slice-to-volume registration of functional MRI},
journal = {Computerized Medical Imaging and Graphics},
volume = {125},
pages = {102643},
year = {2025},
issn = {0895-6111},
doi = {https://doi.org/10.1016/j.compmedimag.2025.102643},
url = {https://www.sciencedirect.com/science/article/pii/S0895611125001521},
author = {Samah Khawaled and Onur Afacan and Simon K. Warfield and Moti Freiman},
keywords = {Slice-to-volume registration, 2D/3D registration, Deep learning, Functional MRI, Uncertainty},
abstract = {Functional Magnetic Resonance Imaging (fMRI) is vital in neuroscience, enabling investigations into brain disorders, treatment monitoring, and brain function mapping. However, head motion during fMRI scans, occurring between shots of slice acquisition, can result in distortion, biased analyses, and increased costs due to the need for scan repetitions. Therefore, retrospective slice-level motion correction through slice-to-volume registration (SVR) is crucial. Previous studies have utilized deep learning (DL) based models to address the SVR task; however, they overlooked the uncertainty stemming from the input stack of slices and did not assign weighting or scoring to each slice. Treating all slices equally ignores the variability in their relevance, leading to suboptimal predictions. In this work, we introduce an end-to-end SVR model for aligning 2D fMRI slices with a 3D reference volume, incorporating a self-attention mechanism to enhance robustness against input data variations and uncertainties. Our SVR model utilizes independent slice and volume encoders and a self-attention module to assign pixel-wise scores for each slice. We used the publicly available Healthy Brain Network (HBN) dataset. We split the volumes into training (64%), validation (16%), and test (20%) sets. To conduct the simulated motion study, we synthesized rigid transformations across a wide range of parameters and applied them to the reference volumes. Slices were then sampled according to the acquisition protocol to generate 2,000, 500, and 200 3D volumeâ€“2D slice pairs for the training, validation, and test sets, respectively. Our experimental results demonstrate that our model achieves competitive performance in terms of alignment accuracy compared to state-of-the-art deep learning-based methods (Euclidean distance of 0.93 [mm] vs. 1.86 [mm], a paired t-test with a p-value of p<0.03). Furthermore, our approach exhibits faster registration speed compared to conventional iterative methods (0.096 s vs. 1.17 s). Our end-to-end SVR model facilitates real-time head motion tracking during fMRI acquisition, ensuring reliability and robustness against uncertainties in the inputs.}
}